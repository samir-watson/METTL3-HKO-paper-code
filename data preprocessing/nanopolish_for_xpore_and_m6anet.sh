# nanopolish specifically for both xpore and m6anet - inclusion of scale index and signal index # this code was ran after mapping with minimap2 so no need to realign
# run after running map_align_nanopolishcomp
########################
A56_1
########################
#!/bin/bash
#SBATCH --partition normal
#SBATCH --mem 96G
#SBATCH --account nanopore_drs
#SBATCH -c 30
#SBATCH -t 2-12:00:00

nanopolish eventalign --reads /home/samirwatson/faststorage/METTL3/DRS_data/basecalled/basecalled_A56_1.fastq \
--bam  /home/samirwatson/faststorage/METTL3/DRS_data/nanocompore/DRS_METTL3_A56_1.aligned.bam \
--genome /home/samirwatson/faststorage/GFP_DRS/GFP_genomes/2GFP+gencode.v33.transcripts_shorthead.fa \
--scale-events \
--signal-index \
--summary /home/samirwatson/faststorage/METTL3/DRS_data/A56_1_HQcalls/sequencing_summary.txt  \
--threads 30 > /home/samirwatson/faststorage/METTL3/DRS_data/m6anet/preprocess/A56_1.m6anet.eventalign.txt

########################
A56_2
########################
#!/bin/bash
#SBATCH --partition normal
#SBATCH --mem 96G
#SBATCH --account nanopore_drs
#SBATCH -c 30
#SBATCH -t 2-12:00:00

nanopolish eventalign --reads /home/samirwatson/faststorage/METTL3/DRS_data/basecalled/basecalled_A56_2.fastq \
--bam  /home/samirwatson/faststorage/METTL3/DRS_data/nanocompore/DRS_METTL3_A56_2.aligned.bam \
--genome /home/samirwatson/faststorage/GFP_DRS/GFP_genomes/2GFP+gencode.v33.transcripts_shorthead.fa \
--scale-events \
--signal-index \
--summary /home/samirwatson/faststorage/METTL3/DRS_data/A56_2_HQcalls/sequencing_summary.txt  \
--threads 30 > /home/samirwatson/faststorage/METTL3/DRS_data/m6anet/preprocess/A56_2.m6anet.eventalign.txt

########################
A56_3
########################
#!/bin/bash
#SBATCH --partition normal
#SBATCH --mem 96G
#SBATCH --account nanopore_drs
#SBATCH -c 30
#SBATCH -t 2-12:00:00

nanopolish eventalign --reads /home/samirwatson/faststorage/METTL3/DRS_data/basecalled/basecalled_A56_3.fastq \
--bam  /home/samirwatson/faststorage/METTL3/DRS_data/nanocompore/DRS_METTL3_A56_3.aligned.bam \
--genome /home/samirwatson/faststorage/GFP_DRS/GFP_genomes/2GFP+gencode.v33.transcripts_shorthead.fa \
--scale-events \
--signal-index \
--summary /home/samirwatson/faststorage/METTL3/DRS_data/A56_3_HQcalls/sequencing_summary.txt  \
--threads 30 > /home/samirwatson/faststorage/METTL3/DRS_data/m6anet/preprocess/A56_3.m6anet.eventalign.txt

########################
WT_1
########################
#!/bin/bash
#SBATCH --partition normal
#SBATCH --mem 96G
#SBATCH --account nanopore_drs
#SBATCH -c 30
#SBATCH -t 2-12:00:00

nanopolish eventalign --reads /home/samirwatson/faststorage/METTL3/DRS_data/basecalled/basecalled_WT_1.fastq \
--bam  /home/samirwatson/faststorage/METTL3/DRS_data/nanocompore/DRS_METTL3_WT_1.aligned.bam \
--genome /home/samirwatson/faststorage/GFP_DRS/GFP_genomes/2GFP+gencode.v33.transcripts_shorthead.fa \
--scale-events \
--signal-index \
--summary /home/samirwatson/faststorage/METTL3/DRS_data/WT_1_HQcalls/sequencing_summary.txt  \
--threads 30 > /home/samirwatson/faststorage/METTL3/DRS_data/m6anet/preprocess/WT_1.m6anet.eventalign.txt

########################
WT_2
########################
#!/bin/bash
#SBATCH --partition normal
#SBATCH --mem 96G
#SBATCH --account nanopore_drs
#SBATCH -c 30
#SBATCH -t 2-12:00:00

nanopolish eventalign --reads /home/samirwatson/faststorage/METTL3/DRS_data/basecalled/basecalled_WT_2.fastq \
--bam  /home/samirwatson/faststorage/METTL3/DRS_data/nanocompore/DRS_METTL3_WT_2.aligned.bam \
--genome /home/samirwatson/faststorage/GFP_DRS/GFP_genomes/2GFP+gencode.v33.transcripts_shorthead.fa \
--scale-events \
--signal-index \
--summary /home/samirwatson/faststorage/METTL3/DRS_data/WT_2_HQcalls/sequencing_summary.txt  \
--threads 30 > /home/samirwatson/faststorage/METTL3/DRS_data/m6anet/preprocess/WT_2.m6anet.eventalign.txt

########################
WT_3
########################
#!/bin/bash
#SBATCH --partition normal
#SBATCH --mem 96G
#SBATCH --account nanopore_drs
#SBATCH -c 30
#SBATCH -t 2-12:00:00

nanopolish eventalign --reads /home/samirwatson/faststorage/METTL3/DRS_data/basecalled/basecalled_WT_3.fastq \
--bam  /home/samirwatson/faststorage/METTL3/DRS_data/nanocompore/DRS_METTL3_WT_3.aligned.bam \
--genome /home/samirwatson/faststorage/GFP_DRS/GFP_genomes/2GFP+gencode.v33.transcripts_shorthead.fa \
--scale-events \
--signal-index \
--summary /home/samirwatson/faststorage/METTL3/DRS_data/WT_3_HQcalls/sequencing_summary.txt  \
--threads 30 > /home/samirwatson/faststorage/METTL3/DRS_data/m6anet/preprocess/WT_3.m6anet.eventalign.txt
